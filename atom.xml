<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>蛙蛙池塘</title>
  <subtitle>欢迎来到蛙蛙池塘</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.ihuhao.com/"/>
  <updated>2016-03-17T04:27:29.000Z</updated>
  <id>http://blog.ihuhao.com/</id>
  
  <author>
    <name>onlytiancai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>开启php-fpm status page</title>
    <link href="http://blog.ihuhao.com/2016/03/17/%E5%BC%80%E5%90%AFphp-fpm-status-page/"/>
    <id>http://blog.ihuhao.com/2016/03/17/开启php-fpm-status-page/</id>
    <published>2016-03-17T04:25:00.000Z</published>
    <updated>2016-03-17T04:27:29.000Z</updated>
    
    <content type="html">&lt;p&gt;要监控PHP运行情况，打开php-fpm的status page可以提供很多有用的信息。&lt;/p&gt;
&lt;p&gt;找到php-fpm的配置路径和master的pid&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ps -ef | grep &amp;quot;php-fpm: master&amp;quot;
root     31236     1  0 11:46 ?        00:00:00 php-fpm: master process (/usr/local/php/etc/php-fpm.conf)  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;修改php-fpm配置，打开status page&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;vi /usr/local/php/etc/php-fpm.conf
pm.status_path = /php_status
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;重启php-fpm&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;kill -USR2 31236
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;找到nginx配置路径&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ps -ef | grep &amp;quot;nginx: master&amp;quot;
root      3813     1  0 Mar09 ?        00:00:00 nginx: master process /usr/local/nginx/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;修改nginx配置，增加localhost的server节&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server  
{
    listen       80;     
    server_name  localhost;
    error_log logs/localhost-error_log;
    access_log logs/localhost-access_log;

    location ~ ^/php_status$ 
    {       
        allow 127.0.0.1;
        deny all;

        include fastcgi_params;
        fastcgi_pass unix:/var/run/php5-fpm.socket; # 根据真实情况改动, 详见php-fpm配置
        fastcgi_param SCRIPT_FILENAME $fastcgi_script_name;
    }       

}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;重启nginx&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/nginx/sbin/nginx -t
/usr/local/nginx/sbin/nginx -s reload
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;测试php-fpm状态页&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# curl localhost/php_status           
pool:                 www
process manager:      static
start time:           17/Mar/2016:12:09:30 +0800
start since:          747
accepted conn:        4992
listen queue:         0
max listen queue:     0
listen queue len:     0
idle processes:       196
active processes:     4
total processes:      200
max active processes: 15
max children reached: 0
slow requests:        0
&lt;/code&gt;&lt;/pre&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;要监控PHP运行情况，打开php-fpm的status page可以提供很多有用的信息。&lt;/p&gt;
&lt;p&gt;找到php-fpm的配置路径和master的pid&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# ps -ef | grep &amp;quot;php-fpm: master&amp;quot;

    
    </summary>
    
    
      <category term="php" scheme="http://blog.ihuhao.com/tags/php/"/>
    
      <category term="监控" scheme="http://blog.ihuhao.com/tags/%E7%9B%91%E6%8E%A7/"/>
    
  </entry>
  
  <entry>
    <title>新的开始</title>
    <link href="http://blog.ihuhao.com/2016/03/06/%E6%96%B0%E7%9A%84%E5%BC%80%E5%A7%8B/"/>
    <id>http://blog.ihuhao.com/2016/03/06/新的开始/</id>
    <published>2016-03-06T11:09:27.000Z</published>
    <updated>2016-03-09T05:50:35.000Z</updated>
    
    <content type="html">&lt;p&gt;在公司申请了新的笔记本，要重新初始化一套新的环境，这几年都习惯了&lt;code&gt;Putty+Vim&lt;/code&gt;开发 ，
但新笔记本默认装了windows，所以得先把linux安装起来，虚拟机就用VirtualBox, 
虚拟机管理用Vagrant，方便管理，打包的镜像也方便移植，下次重装系统还能接着用。&lt;/p&gt;
&lt;p&gt;VirtualBox和Vagrant都从官网下载就可以了，一路next安装好，然后Vagrant的路径在 环境变量里设置一下，方便在cmd下调用。&lt;/p&gt;
&lt;p&gt;然后下周Vagrant的镜像，以后可能要玩docker，所以在&lt;a href=&quot;http://www.vagrantbox.es/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;vagrantbox.es&lt;/a&gt; 上下载了一个&lt;code&gt;CentOS 6.6 x64 (Minimal, VirtualBox Guest Additions&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;东西都下载好了，开搞&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vagrant.exe box add base ..\download\centos-6.6-x86_64.box&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vagrant.exe init base&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vagrant up&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;你会发现，一直卡着，根本就启动不起来，打开VirtualBox看到虚拟机已经在运行了。 但确实vagrant up报错，用ssh也连不上。后来仔细在VirtualBox看了下， 只能装32bit的操作系统，想起来了，需要在BIOS里打开Intel的虚拟化。BIOS设置完重启后 在Virtualbox新建虚拟机选择操作系统时可以看到64bit操作系统了，这时候再&lt;code&gt;vagrant up&lt;/code&gt; 就可以了，具体BIOS设置方式Google下有很多。&lt;/p&gt;
&lt;p&gt;在cmd下打命令还是不习惯，因为习惯了linux终端下的各种命令，快捷键等，所以要下载了 一个&lt;a href=&quot;http://cmder.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;cmder&lt;/a&gt;用，下载完整版的，已经自带ls, grep,git等命令，非常好用。具体设置和使用搜一下。&lt;/p&gt;
&lt;p&gt;用惯了putty，又下载了个&lt;a href=&quot;http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;putty&lt;/a&gt;, 我一般设置如下参数&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;window\appearance\font setting:consolas 12pt &lt;/li&gt;
&lt;li&gt;window\translate\charset:utf-8 &lt;/li&gt;
&lt;li&gt;window\selection\action of mouse buttons:windows .. &lt;/li&gt;
&lt;li&gt;window\line of scoreback:20000 &lt;/li&gt;
&lt;li&gt;connection\auto-login username:root &lt;/li&gt;
&lt;li&gt;connection\seconds of keepalive:10&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;putty登录上去后，安装软件时很慢，发现默认就1G内存，1盒CPU，又把虚拟机配置成2核2G了。&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;config.vm.provider &amp;quot;virtualbox&amp;quot; do |v|&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  v.memory = 1024&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  v.cpus = 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;end&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;再有一个坑，就是Vagrant会默认映射一个目录&lt;code&gt;/vagrant&lt;/code&gt;, 这个目录下执行chmod等是不起 作用的，因为它还在windows上，不支持linux文件权限。往里安装一个软件时，会有意想不到 的坑等着你，比如mysql的my.cnf配置就需要特殊的权限，否则mysql是启动不起来的。&lt;/p&gt;
&lt;p&gt;登录centos后，发现yum等都不能用，因为公司上网需要代理，所以要设置yum,wget的代理&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ vi ~/.wgetrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;use_proxy=yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;http_proxy=proxy.xxx.com:8080&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ vi /etc/yum.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;proxy=http://proxy.xxx.com:8080&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后就是在centos上把&lt;code&gt;.vimrc&lt;/code&gt;简单配置下。&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;set nocp&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set ts=4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set sw=4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set smarttab&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set et&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set nu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set ambiwidth=double&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;filetype plugin indent on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set encoding=UTF-8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set langmenu=zh_CN.UTF-8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;language message zh_CN.UTF-8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set fileencodings=ucs-bom,utf-8,cp936,gb18030,big5,euc-jp,euc-kr,latin1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set fileencoding=utf-8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;好了，基本搞定开发环境了，可以愉快的在centos上玩耍了。&lt;/p&gt;
&lt;p&gt;参考链接&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/astaxie/Go-in-Action/blob/master/ebook/zh/01.2.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Vgrant安装配置&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;在公司申请了新的笔记本，要重新初始化一套新的环境，这几年都习惯了&lt;code&gt;Putty+Vim&lt;/code&gt;开发 ，
但新笔记本默认装了windows，所以得先把linux安装起来，虚拟机就用VirtualBox, 
虚拟机管理用Vagrant，方便管理，打包的镜像也方便移
    
    </summary>
    
    
      <category term="vagrant" scheme="http://blog.ihuhao.com/tags/vagrant/"/>
    
      <category term="centos" scheme="http://blog.ihuhao.com/tags/centos/"/>
    
      <category term="putty" scheme="http://blog.ihuhao.com/tags/putty/"/>
    
      <category term="cmder" scheme="http://blog.ihuhao.com/tags/cmder/"/>
    
      <category term="vim" scheme="http://blog.ihuhao.com/tags/vim/"/>
    
  </entry>
  
</feed>
